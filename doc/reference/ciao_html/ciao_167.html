<HTML>
<HEAD>
<!-- Created by texi2html 1.56k + clip patches and <A href="http://www.clip.dia.fi.upm.es/Software">lpdoc</A> from ciao.texi on 16 May 2002 -->

<LINK rel="stylesheet" href="ciao.css" type="text/css">
<TITLE>The Ciao Prolog System               - The Ciao lpmake scripting facility</TITLE>
</HEAD>
<BODY> 
Go to the <A HREF="ciao_1.html">first</A>, <A HREF="ciao_166.html">previous</A>, <A HREF="ciao_168.html">next</A>, <A HREF="ciao_215.html">last</A> section, <A HREF="ciao_toc.html">table of contents</A>.
<P><HR><P>


<H1><A NAME="SEC654" HREF="ciao_toc.html#TOC654">The Ciao lpmake scripting facility</A></H1>

<P>
<STRONG>Author(s):</STRONG> Manuel Hermenegildo, <CODE>clip@dia.fi.upm.es</CODE>, <CODE>http://www.clip.dia.fi.upm.es/</CODE>, The CLIP Group, Facultad de Inform&aacute;tica, Universidad Polit&eacute;cnica de Madrid.


<P>
 


<P>
<A NAME="IDX6446"></A>
<A NAME="IDX6447"></A>
<A NAME="IDX6448"></A>
<A NAME="IDX6449"></A>


<P>
<STRONG>Note:</STRONG> 
<A NAME="IDX6450"></A>
<CODE>lpmake</CODE> and the 
<A NAME="IDX6451"></A>
<CODE>make</CODE> library are still under active development, and they may change substantially in future releases. 


<P>
<A NAME="IDX6452"></A>
<CODE>lpmake</CODE> is a Ciao application which uses the Ciao 
<A NAME="IDX6453"></A>
<CODE>make</CODE> library to implement a dependency-driven scripts in a similar way to the Un*x 
<A NAME="IDX6454"></A>
<CODE>make</CODE> facility. 


<P>
The original purpose of the Un*x 
<A NAME="IDX6455"></A>
<CODE>make</CODE> utility is to determine automatically which pieces of a large program needed to be recompiled, and issue the commands to recompile them. In practice, 
<A NAME="IDX6456"></A>
<CODE>make</CODE> is often used for many other purposes: it can be used to describe any task where some files must be updated automatically from others whenever the others change. 
<A NAME="IDX6457"></A>
<CODE>lpmake</CODE> can be used for the same types of applications as 
<A NAME="IDX6458"></A>
<CODE>make</CODE>, and also for some new ones, and offers a number of advantages over 
<A NAME="IDX6459"></A>
<CODE>make</CODE>. The first one is <EM>portability</EM>. When compiled to a bytecode executable 
<A NAME="IDX6460"></A>
<CODE>lpmake</CODE> runs on any platform where a Ciao engine is available. Also, the fact that typically many of the operations are programmed in Prolog within the makefile, not needing external applications, improves portability further. The second advantage of 
<A NAME="IDX6461"></A>
<CODE>lpmake</CODE> is <EM>improved programming capabilities</EM>. While 
<A NAME="IDX6462"></A>
<CODE>lpmake</CODE> is simpler than 
<A NAME="IDX6463"></A>
<CODE>make</CODE>, 
<A NAME="IDX6464"></A>
<CODE>lpmake</CODE> allows using the Ciao Prolog language within the scripts. This allows establising more complex dependencies and programming powerful operations within the make file, and without resorting to external packages (e.g., operating system commands), which also helps portability. A final advantage of 
<A NAME="IDX6465"></A>
<CODE>lpmake</CODE> is that it supports a form of <EM>autodocumentation</EM>: 
<A NAME="IDX6466"></A>
<A NAME="IDX6467"></A>
comments associated to targets can be included in the configuration files. Calling 
<A NAME="IDX6468"></A>
<CODE>lpmake</CODE> in a directory which has such a configuration file explains what commands the configuration file support and what these commands will do. 



<UL>
<LI><A HREF="ciao_167.html#SEC655">General operation</A>
<LI><A HREF="ciao_167.html#SEC656">lpmake usage</A>
<LI><A HREF="ciao_167.html#SEC657">Acknowledgments (lpmake)</A>
</UL>



<H2><A NAME="SEC655" HREF="ciao_toc.html#TOC655">General operation</A></H2>

<P>
To prepare to use 
<A NAME="IDX6469"></A>
<CODE>lpmake</CODE>, and in a similar way to 
<A NAME="IDX6470"></A>
<CODE>make</CODE>, you must write a file (typically called 
<A NAME="IDX6471"></A>
<CODE>Makefile.pl</CODE>) that describes the relationships among files in your program or application, and states the commands for updating each file. In a program, typically the executable file is updated from object files, which are in turn made by compiling source files. Another example is running 
<A NAME="IDX6472"></A>
<CODE>latex</CODE> and 
<A NAME="IDX6473"></A>
<CODE>dvips</CODE> on a set of source <CODE>.tex</CODE> files to generate a document in <CODE>dvi</CODE> and <CODE>postscript</CODE> formats. Once a suitable makefile exists, each time you change some source files, simply typing <CODE>lpmake</CODE> suffices to perform all necessary operations (recompilations, processing text files, etc.). The 
<A NAME="IDX6474"></A>
<CODE>lpmake</CODE> program uses the dependency rules in the makefile and the last modification times of the files to decide which of the files need to be updated. For each of those files, it issues the commands recorded in the makefile. For example, in the 
<A NAME="IDX6475"></A>
<CODE>latex</CODE>/
<A NAME="IDX6476"></A>
<CODE>dvips</CODE> case one rule states that the <CODE>.dvi</CODE> file whould be updated from the <CODE>.tex</CODE> files whenever one of them changes and another rule states that the <CODE>.ps</CODE> file needs to be updated from a <CODE>.dvi</CODE> file every time it changes. The rule also describe the commands to be issued to update the files. 


<P>
So, the general process is as follows: 
<A NAME="IDX6477"></A>
<CODE>lpmake</CODE> executes commands in the 
<A NAME="IDX6478"></A>
<CODE>Makefile.pl</CODE> to update one or more target <EM>names</EM>, where <EM>name</EM> is often a program, but can also be a file to be generated or even a "virtual" target. If no <CODE>-l</CODE> or <CODE>-m</CODE> options are present, 
<A NAME="IDX6479"></A>
<CODE>lpmake</CODE> will look for the makefile 
<A NAME="IDX6480"></A>
<CODE>Makefile.pl</CODE>. 
<A NAME="IDX6481"></A>
<CODE>lpmake</CODE> updates a target if it depends on prerequisite files that have been modified since the target was last modified, or if the target does not exist. You can provide command line arguments to 
<A NAME="IDX6482"></A>
<CODE>lpmake</CODE> to control which files should be regenerated, or how. 




<H2><A NAME="SEC656" HREF="ciao_toc.html#TOC656">lpmake usage</A></H2>


<PRE>

Supported command line options:

[-v] [-u &#60;.../Configfile.pl&#62;] &#60;command1&#62; ... &#60;commandn&#62;

  Process commands &#60;command1&#62; ... &#60;commandn&#62;, using user 
  file &#60;.../Configfile.pl&#62; as configuration file. If no 
  configuration file is specified a file 'Makefile.pl' in 
  the current directory will be used. 

[-v] [-m &#60;.../Configfile.pl&#62;] &#60;command1&#62; ... &#60;commandn&#62;

  Same as above, but the configuration file is a module. 
  Making this file a module is useful to implement 
  inherintance across diferent configuration files, i.e., 
  the values declared in a configuration file can be 
  easily made to override those defined in another.

  Optional argument '-v' produces verbose output, reporting 
  on the processing of the dependency rules. Very useful 
  for debugging Makefiles.

-h     [ -u &#60;.../Configfile.pl&#62; ]
-h     [ -m &#60;.../Configfile.pl&#62; ]
-help  [ -u &#60;.../Configfile.pl&#62; ]
-help  [ -m &#60;.../Configfile.pl&#62; ]

  Print this help message. If a configuration file is given, 
  and the commands in it are commented, then information on 
  these commands is also printed.

</PRE>



<H2><A NAME="SEC657" HREF="ciao_toc.html#TOC657">Acknowledgments (<CODE>lpmake</CODE>)</A></H2>

<P>
Some parts of the documentation are taken from the documentation of GNU's 
<A NAME="IDX6483"></A>
<CODE>gmake</CODE>.


<P><HR><P>
Go to the <A HREF="ciao_1.html">first</A>, <A HREF="ciao_166.html">previous</A>, <A HREF="ciao_168.html">next</A>, <A HREF="ciao_215.html">last</A> section, <A HREF="ciao_toc.html">table of contents</A>.
</BODY>
</HTML>
