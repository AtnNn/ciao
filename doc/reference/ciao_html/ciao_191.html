<HTML>
<HEAD>
<!-- Created by texi2html 1.56k + clip patches and <A href="http://www.clip.dia.fi.upm.es/Software">lpdoc</A> from ciao.texi on 25 June 2004 -->

<LINK rel="stylesheet" href="ciao.css" type="text/css">
<TITLE>The Ciao Prolog System               - XML query library</TITLE>
</HEAD>
<BODY> 
Go to the <A HREF="ciao_1.html">first</A>, <A HREF="ciao_190.html">previous</A>, <A HREF="ciao_192.html">next</A>, <A HREF="ciao_241.html">last</A> section, <A HREF="ciao_toc.html">table of contents</A>.
<P><HR><P>


<H1><A NAME="SEC758" HREF="ciao_toc.html#TOC758">XML query library</A></H1>
<P>
<A NAME="IDX8325"></A>


<P>
<STRONG>Author(s):</STRONG> José Manuel Gómez Pérez.


<P>
<STRONG>Version:</STRONG> 0.1 (2003/12/1, 13:24:9 CET)


<P>
This package provides a language suitable for querying XML documents from a Prolog program. Constraint programming expresions can be included in order to prune search as soon as possible, i.e. upon constraint unsatisfability, improving efficiency. Also, facilities are offerd to improve search speed by transforming XML documents into Prolog programs, hence reducing search to just running the program and taking advantage of Prolog's indexing capabilities. 


<P>
Queries in an XML document have a recursive tree structructure that permits to detail the search on the XML element sought, its attributes, and its children. As a suffix, a constraint programming expression can be added. Queries return value for the free variables included (in case of success), and checks whether the XML document structure matches that depicted by the query itself. 


<P>
The operators introduced are described below: 



<UL>
 
<LI><EM>@</EM> Delimits a subquery on an elment's attribute, such as <CODE>product@val(product_name, "car")</CODE>, the first argument being the attribute name and the second its value. Any of them can be free variables, being possible to write queries like <CODE>product@val(Name, "car")</CODE>, intended to find the 'Name' of attributes of element product whose value is the string "car".

<LI><EM>::</EM> The right-hand side of the subexpression delimited by this operator is a query on the children elements of the element described on its left-hand side.

<LI><EM>with</EM> Declares the constraints the items sought must satisfy.

</UL>

<P>
Some examples of this query language (more can be found in the examples directory): 



<UL>
<LI>Example A:

</UL>

<P>



<PRE>
product@val(product_name,"car")::(quantity(X), 
                                  'time-left'(Y), 
                                  negotiation::preference::price(Z)) 
       with X * Z .&#62;. Y

</PRE>


<UL>
<LI>Example B:

</UL>

<P>



<PRE>
nitf::head::docdata::'doc-id'@val('id-string',"020918050")::(Y), 
                     body::'body.head'::abstract::p(X)

</PRE>


<UL>
<LI><A HREF="ciao_191.html#SEC759">Usage and interface (xml_path)</A>
<LI><A HREF="ciao_191.html#SEC760">Documentation on exports (xml_path)</A>
<LI><A HREF="ciao_191.html#SEC761">Documentation on internals (xml_path)</A>
</UL>



<H2><A NAME="SEC759" HREF="ciao_toc.html#TOC759">Usage and interface (<CODE>xml_path</CODE>)</A></H2>

<div class="cartouche">

<UL>

<LI><STRONG>Library usage:</STRONG>

<CODE>:- use_package(xml_path).</CODE>

or

<CODE>:- module(...,...,[xml_path]).</CODE>

<LI><STRONG>Exports:</STRONG>


<UL>

<LI><EM>Predicates:</EM>

<A NAME="IDX8326"></A>
<CODE>xml_search/3</CODE>, 
<A NAME="IDX8327"></A>
<CODE>xml_parse/3</CODE>, 
<A NAME="IDX8328"></A>
<CODE>xml_parse_match/3</CODE>, 
<A NAME="IDX8329"></A>
<CODE>xml_search_match/3</CODE>, 
<A NAME="IDX8330"></A>
<CODE>xml_index_query/3</CODE>, 
<A NAME="IDX8331"></A>
<CODE>xml_index_to_file/2</CODE>, 
<A NAME="IDX8332"></A>
<CODE>xml_index/1</CODE>, 
<A NAME="IDX8333"></A>
<CODE>xml_query/3</CODE>.

</UL>

<LI><STRONG>New operators defined:</STRONG>

<A NAME="IDX8334"></A>
<CODE>@/2</CODE> [200,yfx], 
<A NAME="IDX8335"></A>
<CODE>::/2</CODE> [300,xfy], 
<A NAME="IDX8336"></A>
<CODE>with/2</CODE> [800,yfx].

<LI><STRONG>Other modules used:</STRONG>


<UL>

<LI><EM>System library modules:</EM>

<A NAME="IDX8337"></A>
<CODE>xml_path/xml_path_types</CODE>.

</UL>

</UL>

</div class="cartouche">



<H2><A NAME="SEC760" HREF="ciao_toc.html#TOC760">Documentation on exports (<CODE>xml_path</CODE>)</A></H2>
<P>
<A NAME="IDX8338"></A>
<A NAME="IDX8339"></A>
<DL>
<DT><span class="define">PREDICATE:</span> <B>xml_search/3:</B>
<DD><A NAME="IDX8340"></A>


<P>
<STRONG>Usage:</STRONG> <CODE>xml_search(+Query, +Source, -Doc)</CODE>

<UL>
<LI><EM>Description:</EM> Checks a high level query <CODE>Query</CODE> against an XML document <CODE>Source</CODE>. If the query is successful it retuns in <CODE>Doc</CODE> the whole xml element(s) of the document that matched it.

<LI><EM>The following properties should hold at call time:</EM>

<CODE>+Query</CODE> is a primitive XML query.
 (<CODE>xml_path_types:canonic_xml_query/1</CODE>)

<CODE>+Source</CODE> is either a XML attribute, a XML element or a line break.
 (<CODE>xml_path_types:canonic_xml_item/1</CODE>)

<CODE>-Doc</CODE> is either a XML attribute, a XML element or a line break.
 (<CODE>xml_path_types:canonic_xml_item/1</CODE>)
</UL>

</DL>

<P>
<A NAME="IDX8341"></A>
<A NAME="IDX8342"></A>
<DL>
<DT><span class="define">PREDICATE:</span> <B>xml_parse/3:</B>
<DD><A NAME="IDX8343"></A>


<P>
<STRONG>Usage:</STRONG> <CODE>xml_parse(+Query, +Source, -Doc)</CODE>

<UL>
<LI><EM>Description:</EM> Checks a high level query <CODE>Query</CODE> against an XML document <CODE>Source</CODE>. If the query is successful it retuns in <CODE>Doc</CODE> the whole xml element(s) of the document that matched it. On the contrary as

<A NAME="IDX8344"></A>
<CODE>xml_search/3</CODE>, the query can start at any level of the XML document, not necessarily at the root node. 
<LI><EM>The following properties should hold at call time:</EM>

<CODE>+Query</CODE> is a primitive XML query.
 (<CODE>xml_path_types:canonic_xml_query/1</CODE>)

<CODE>+Source</CODE> is either a XML attribute, a XML element or a line break.
 (<CODE>xml_path_types:canonic_xml_item/1</CODE>)

<CODE>-Doc</CODE> is either a XML attribute, a XML element or a line break.
 (<CODE>xml_path_types:canonic_xml_item/1</CODE>)
</UL>

</DL>

<P>
<A NAME="IDX8345"></A>
<A NAME="IDX8346"></A>
<DL>
<DT><span class="define">PREDICATE:</span> <B>xml_parse_match/3:</B>
<DD><A NAME="IDX8347"></A>


<P>
<STRONG>Usage:</STRONG> <CODE>xml_parse_match(+Query, +Source, -Match)</CODE>

<UL>
<LI><EM>Description:</EM> Checks a high level query <CODE>Query</CODE> against an XML document <CODE>Source</CODE>. If the query is successful it retuns in <CODE>Doc</CODE> the exact subtree of the xml document that matched it. On the contrary as

<A NAME="IDX8348"></A>
<CODE>'$xml_search_match/3</CODE>, the query can start at any level of the XML document, not necessarily at the root node. 
<LI><EM>The following properties should hold at call time:</EM>

<CODE>+Query</CODE> is a primitive XML query.
 (<CODE>xml_path_types:canonic_xml_query/1</CODE>)

<CODE>+Source</CODE> is either a XML attribute, a XML element or a line break.
 (<CODE>xml_path_types:canonic_xml_item/1</CODE>)

<CODE>-Match</CODE> is either a XML attribute, a XML element or a line break.
 (<CODE>xml_path_types:canonic_xml_item/1</CODE>)
</UL>

</DL>

<P>
<A NAME="IDX8349"></A>
<A NAME="IDX8350"></A>
<DL>
<DT><span class="define">PREDICATE:</span> <B>xml_search_match/3:</B>
<DD><A NAME="IDX8351"></A>


<P>
<STRONG>Usage:</STRONG> <CODE>xml_search_match(+BasicQuery, +SourceDoc, -Match)</CODE>

<UL>
<LI><EM>Description:</EM> Checks query <CODE>Query</CODE> against an XML document <CODE>Source</CODE>. If the query is successful it retuns in <CODE>Doc</CODE> the exact subtree of the xml document that matched it.

<LI><EM>The following properties should hold at call time:</EM>

<CODE>+BasicQuery</CODE> is a primitive XML query.
 (<CODE>xml_path_types:canonic_xml_query/1</CODE>)

<CODE>+SourceDoc</CODE> is either a XML attribute, a XML element or a line break.
 (<CODE>xml_path_types:canonic_xml_item/1</CODE>)

<CODE>-Match</CODE> is either a XML attribute, a XML element or a line break.
 (<CODE>xml_path_types:canonic_xml_item/1</CODE>)
</UL>

</DL>

<P>
<A NAME="IDX8352"></A>
<A NAME="IDX8353"></A>
<DL>
<DT><span class="define">PREDICATE:</span> <B>xml_index_query/3:</B>
<DD><A NAME="IDX8354"></A>


<P>
<STRONG>Usage:</STRONG> <CODE>xml_index_query(+Query, -Id, -Match)</CODE>

<UL>
<LI><EM>Description:</EM>  Matches a high level query <CODE>Query</CODE> against an XML document previously transformed into a Prolog program. <CODE>Id</CODE> identifies the resulting document <CODE>Match</CODE>, which is the exact match of the query against the XML document.

<LI><EM>The following properties should hold at call time:</EM>

<CODE>+Query</CODE> is a primitive XML query.
 (<CODE>xml_path_types:canonic_xml_query/1</CODE>)

<CODE>-Id</CODE> is an atom.
 (<CODE>basic_props:atm/1</CODE>)

<CODE>-Match</CODE> is either a XML attribute, a XML element or a line break.
 (<CODE>xml_path_types:canonic_xml_item/1</CODE>)
</UL>

</DL>

<P>
<A NAME="IDX8355"></A>
<A NAME="IDX8356"></A>
<DL>
<DT><span class="define">PREDICATE:</span> <B>xml_index_to_file/2:</B>
<DD><A NAME="IDX8357"></A>


<P>
<STRONG>Usage:</STRONG> <CODE>xml_index_to_file(SourceDoc, File)</CODE>

<UL>
<LI><EM>Description:</EM> Transforms the XML document <CODE>SourceDoc</CODE> in a Prolog program which is output to file <CODE>File</CODE>.

<LI><EM>The following properties should hold at call time:</EM>

<CODE>SourceDoc</CODE> is either a XML attribute, a XML element or a line break.
 (<CODE>xml_path_types:canonic_xml_item/1</CODE>)

<CODE>File</CODE> is an atom.
 (<CODE>basic_props:atm/1</CODE>)
</UL>

</DL>

<P>
<A NAME="IDX8358"></A>
<A NAME="IDX8359"></A>
<DL>
<DT><span class="define">PREDICATE:</span> <B>xml_index/1:</B>
<DD><A NAME="IDX8360"></A>


<P>
<STRONG>Usage:</STRONG> <CODE>xml_index(SourceDoc)</CODE>

<UL>
<LI><EM>Description:</EM> Transforms the XML document <CODE>SourceDoc</CODE> in a Prolog program, generating the associated clauses, which are stored dynamically into the current process memory space.

<LI><EM>The following properties should hold at call time:</EM>

<CODE>SourceDoc</CODE> is either a XML attribute, a XML element or a line break.
 (<CODE>xml_path_types:canonic_xml_item/1</CODE>)
</UL>

</DL>

<P>
<A NAME="IDX8361"></A>
<A NAME="IDX8362"></A>
<DL>
<DT><span class="define">PREDICATE:</span> <B>xml_query/3:</B>
<DD><A NAME="IDX8363"></A>


<P>
<STRONG>Usage:</STRONG> <CODE>xml_query(+Query, +Doc, -Match)</CODE>

<UL>
<LI><EM>Description:</EM> Checks that XML document <CODE>Doc</CODE> is compliant with respect to the query <CODE>Query</CODE> expressed in the low level query language. The exact mapping of the query over the document is returned in <CODE>Match</CODE>

<LI><EM>The following properties should hold at call time:</EM>

<CODE>+Query</CODE> is a primitive XML query.
 (<CODE>xml_path_types:canonic_xml_query/1</CODE>)

<CODE>+Doc</CODE> is either a XML attribute, a XML element or a line break.
 (<CODE>xml_path_types:canonic_xml_item/1</CODE>)

<CODE>-Match</CODE> is either a XML attribute, a XML element or a line break.
 (<CODE>xml_path_types:canonic_xml_item/1</CODE>)
</UL>

</DL>



<H2><A NAME="SEC761" HREF="ciao_toc.html#TOC761">Documentation on internals (<CODE>xml_path</CODE>)</A></H2>
<P>
<A NAME="IDX8364"></A>
<A NAME="IDX8365"></A>
<DL>
<DT><span class="define">REGTYPE:</span> <B>canonic_xml_term/1:</B>
<DD><A NAME="IDX8366"></A>


<P>
<STRONG>Usage:</STRONG> <CODE>canonic_xml_term(XMLTerm)</CODE>

<UL>
<LI><EM>Description:</EM> <CODE>XMLTerm</CODE> is a term representing XML code in canonical form.

</UL>

</DL>

<P>
<A NAME="IDX8367"></A>
<A NAME="IDX8368"></A>
<DL>
<DT><span class="define">REGTYPE:</span> <B>canonic_xml_item/1:</B>
<DD><A NAME="IDX8369"></A>


<P>
<STRONG>Usage:</STRONG> <CODE>canonic_xml_item(XMLItem)</CODE>

<UL>
<LI><EM>Description:</EM> <CODE>XMLItem</CODE> is either a XML attribute, a XML element or a line break.

</UL>

</DL>

<P>
<A NAME="IDX8370"></A>
<A NAME="IDX8371"></A>
<DL>
<DT><span class="define">REGTYPE:</span> <B>tag_attrib/1:</B>
<DD><A NAME="IDX8372"></A>


<P>
<STRONG>Usage:</STRONG> <CODE>tag_attrib(Att)</CODE>

<UL>
<LI><EM>Description:</EM> <CODE>Att</CODE> is a XML attribute.

</UL>

</DL>

<P>
<A NAME="IDX8373"></A>
<A NAME="IDX8374"></A>
<DL>
<DT><span class="define">REGTYPE:</span> <B>canonic_xml_query/1:</B>
<DD><A NAME="IDX8375"></A>


<P>
<STRONG>Usage:</STRONG> <CODE>canonic_xml_query(Query)</CODE>

<UL>
<LI><EM>Description:</EM> <CODE>Query</CODE> is a primitive XML query.

</UL>

</DL>

<P>
<A NAME="IDX8376"></A>
<A NAME="IDX8377"></A>
<DL>
<DT><span class="define">REGTYPE:</span> <B>canonic_xml_subquery/1:</B>
<DD><A NAME="IDX8378"></A>


<P>
<STRONG>Usage:</STRONG> <CODE>canonic_xml_subquery(SQuery)</CODE>

<UL>
<LI><EM>Description:</EM> <CODE>SQuery</CODE> defines a XML subquery.

</UL>

</DL>

<P><HR><P>
Go to the <A HREF="ciao_1.html">first</A>, <A HREF="ciao_190.html">previous</A>, <A HREF="ciao_192.html">next</A>, <A HREF="ciao_241.html">last</A> section, <A HREF="ciao_toc.html">table of contents</A>.
</BODY>
</HTML>
